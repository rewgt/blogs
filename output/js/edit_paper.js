window.W||(window.W=new Array,W.$modules=[]),W.$modules.push(function(a,b,c){function p(a){return a.getBoundingClientRect()}function q(a){var b=document.createElement("a");return b.href=a,""==b.host&&(b.href=b.href),b}function r(a){a.stopPropagation()}function s(a,b){return b?b.querySelector(a):document.querySelector(a)}function t(a,b,c){"string"==typeof a?s(a).addEventListener(b,c,!1):a.addEventListener(b,c,!1)}function X(a){var b=W[a];b||(b=a);var c=/^#[0-9A-Fa-f]+/,d=c.exec(b);if(d){var e=d[0].slice(1);if(3==e.length)return[parseInt("0x"+e[0]+e[0]),parseInt("0x"+e[1]+e[1]),parseInt("0x"+e[2]+e[2])];if(e.length>=6)return[parseInt("0x"+e.slice(0,2)),parseInt("0x"+e.slice(2,4)),parseInt("0x"+e.slice(4,6))]}else{if(d=/^(rgb|rgba)\s*\(([^)]*)\)/.exec(b)){for(var i,g=d[2].split(","),h=0;i=g[h];h++)g[h]=h<3?parseInt(i)||0:parseFloat(i);return g}}return null}function Y(){document.getElementById("color-dlg").style.display="none",V=null,H.style.display="none",I.style.display="none"}function Z(a){for(var f,b=a?"none":"block",c=a?"block":"none",d=v.parentNode,e=0;f=d.children[e];e++)f.style.display=f===v?b:c;N.style.display=a?"block":"none"}function _(a){if($&&n){var b=n.componentOf($+".txt");b&&(b.duals["html."]=M.value)}}function da(a,b,c){function d(){return new Array(b+1).join("  ")}b=b||0;var e,f,g,h=a[0],i=0;Array.isArray(h)?(i=a.length-1,e=h[0],f=h[1],g=h[2]):(e=h,f=a[1],g=a[2]),"number"!=typeof g&&(g=ba[e]||3);var j=d(),k=j;if(!e){var l=f.html||[],m=c<=1?"<div class='rewgt-static'>":"<span class='rewgt-static'>",n=c<=1?"</div>":"</span>";return 0==l.length?k="":1==l.length?k+=m+l[0]+n+"\n":(k+=m+"\n",l.forEach(function(a){k+=j+"  "+a+"\n"}),k+=j+n+"\n"),k}var p=!1;"RefDiv"==e?(!0,p=f["isPre."],i=0,k+=(p?"<pre $=":"<div $=")+JSON.stringify(f.$||"")):"RefSpan"==e?(!0,i=0,k+="<span $="+JSON.stringify(f.$||"")):3==g?k+="<span $="+e:(p=f["isPre."],!p&&ca[e]&&(p=!0),p&&(i=0),k+=(p?"<pre $=":"<div $=")+e);var q=f.key,r=f["html."];q&&(k+=" key='"+q+"'");for(var s in f)if("key"!=s&&"html."!=s&&"$"!=s&&"isPre."!=s){var t=f[s];void 0!==t&&(k+=" "+s.replace(aa,"-$1").toLowerCase()+"=","string"!=typeof t||"$"!=s[0]&&t&&"{"==t[0]&&"}"==t.slice(-1)?k+="'{"+JSON.stringify(t).replace(/&/g,"&amp;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"}'":k+=JSON.stringify(t))}if(i){for(var w,u="",v=1;w=a[v];v+=1)u+=da(w,b+1,g);3==g?u.startsWith(j+"  ")?k+=">"+u.slice(j.length+2):k+=">"+u:k+=">\n"+u}else k+=">",r&&(k+=p?r:r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"));return p?k+="</pre>\n":3==g?k+="</span>\n":r||"\n"!=k.slice(-1)?k+="</div>\n":k+=j+"</div>\n",k}function ea(a,b,c,d,e){if(!Array.isArray(d.widget))return!1;var f=da(d.widget,e,1);if(!f)return!1;if(e>0){var g=new Array(e+1).join("  ");f.startsWith(g)&&(f=f.slice(g.length))}if("number"==typeof b){var h=a.value;a.value=h.slice(0,b)+f+h.slice(c),a.selectionEnd=a.selectionStart=b+f.length}else if(document.selection){a.focus();var i=document.selection.createRange();i.text=f}else a.value=a.value+f;return!0}function fa(a){var b="";if(Qb(a.dataTransfer,"application/json")){var c=null,d=a.dataTransfer.getData("application/json")||"{}";try{c=JSON.parse(d)}catch(a){console.log(a)}if(c){var e;if("image"==c.dragType&&(e=c.dragUrl)){var f=q("./").pathname;"/"!=f[0]&&(f="/"+f);var g=q(e).pathname;"/"!=g[0]&&(g="/"+g),g.startsWith(f)&&(g=g.slice(f.length));var h=g.split("/").pop();b="number"==typeof c.clientWidth?'<img alt="'+h+'" style="width:'+c.clientWidth+"px; height:"+c.clientHeight+'px" src="'+g+'">':"!["+h+"]("+g+")"}else if("template"==c.dragType&&(e=c.dragUrl)){var i=this.selectionStart,j=this.selectionEnd,k=0;if("number"==typeof i){var l=this.value.slice(0,i).split("\n").pop();l.trim()||(k=Math.floor(l.length/2))}var m=this,n=c.option;return n?n.name&&ea(m,i,j,n,k)&&_():(e+=".json",Sb(e,function(a,b){if(a)rootNode.instantShow("error: read JSON failed ("+e+")."),console.log(a);else{try{n=JSON.parse(b)}catch(a){console.log("error: parse JSON failed ("+e+").")}n&&n.name&&ea(m,i,j,n,k)&&_()}})),a.preventDefault(),void a.stopPropagation()}}}else if(Qb(a.dataTransfer,"text/uri-list")){var e=a.dataTransfer.getData("text/uri-list")||"";if(e){var f=q("./").pathname;"/"!=f[0]&&(f="/"+f);var g=q(e).pathname;"/"!=g[0]&&(g="/"+g),g.startsWith(f)&&(g=g.slice(f.length)),b="["+g.split("/").pop()+"]("+g+")"}}if(b){a.preventDefault(),a.stopPropagation();var i=this.selectionStart;if("number"==typeof i){var o=this.value;this.value=o.slice(0,i)+b+o.slice(this.selectionEnd),this.selectionEnd=this.selectionStart=i+b.length}else if(document.selection){this.focus();var p=document.selection.createRange();p.text=b}else this.value=this.value+b;_()}}function ga(){P.innerHTML="",P.style.display="none",R.style.display="none",Q.style.display="none",qa="",Z(!1),O.focus(),setTimeout(function(){$="",M.value=""},0)}function ha(a,b){var c=s("div.link",a),d=s("div.clone",a),e=s("div.fork",a),f=s("div.rotate",a),g=s("div.klass",a);"widget"==b?(c.style.display="block",d.style.display="block",e.style.display="block",f.style.display="block",g.style.display="block"):(e.style.display="none",f.style.display="none",g.style.display="none","arrow"==b?(c.style.display="block",d.style.display="none"):"auto-arrow"==b?(c.style.display="none",d.style.display="none"):"iso-arrow"==b&&(c.style.display="block",d.style.display="block"))}function ia(a,b,c,d,e,f){for(var g=b.length,h=1,i=1,j=1;j<g;j+=2){var k=b[j-1],l=b[j];k>h&&(h=k),l>i&&(i=l)}var m=e/h,n=f/i;a.rateX=m,a.rateY=n;for(var o="",p=1,j=3;j<g;j+=2){var k=b[j-1]*m+c,l=b[j]*n+d;o+='<div class="pointer" _pos="'+p+'" style="left:'+k+"px; top:"+l+'px"></div>',p+=1}return o}function ja(a,b,c){var d;if(a&&b&&Array.isArray(d=a.state["svg.cfg"])){var e=a.state.stroke||3,g=((a.state.style.strokeColor||"rgb(119,119,119)").trim(),(a.state.style.fillColor||"rgb(119,119,119)").trim()),h=100,i=X(g);i&&i.length>=4&&(h=Math.floor(100*i[3]));var j=d[0]||0,m=d[1]||[],n=0,o=0,q="",r=m.slice(4);m.length>=1&&(q=m[0]),m.length>=3&&(n=m[2]),m.length>=4&&(o=m[3]);var s=!1;if(j>=0){var t=a.componentOf("txt");t&&(s=!0,M.value=t.state["html."]||"",$=c)}var u="visible";s||(u="hidden",setTimeout(function(){M.value="",$=""},0)),K.style.visibility=u,L.style.visibility=u,z.value=h+"",A.value=e+"";var v='<svg width="60" height="14"><line stroke="#ff7f00" stroke-width="1" ';q&&(v+='stroke-dasharray="'+q+'" '),v+='x1="0%" y1="60%" x2="100%" y2="60%"/></svg>',D.innerHTML=v;var w=a.state["data-from"];if(j<0&&!w){n<1&&(n=1);var x=nb[n-1],v='<svg width="18" height="18" viewBox="0 0 100 100"><path stroke="#ff7f00" fill="#ff7f00" stroke-width="10" d="';v+=x+'"/></svg>',B.innerHTML=v,B.style.visibility="visible"}else B.style.visibility="hidden";if(o>=1&&o<=6){var x=mb[o-1],v='<svg width="18" height="18" viewBox="0 0 100 100"><path stroke="#ff7f00" fill="#ff7f00" stroke-width="10" d="';v+=x+'"/></svg>',C.innerHTML=v,C.style.visibility="visible"}else C.style.visibility="hidden";u=j<0?"hidden":"visible",E.style.visibility=u,F.style.visibility=u,G.style.visibility=u;var y=p(b);if(j<0){var H=Math.floor(2.5*e+.5);H*=l,P.innerHTML=ia(P,r,y.left+H,y.top-S+H,y.width-H-H,y.height-H-H),P.style.display="block",P.classList.remove("no-move")}else P.style.display="none";if(w&&j<0){R.style.display="none";var I=!b.getAttribute("data-align");Q.style.display="block",I?ha(Q,"auto-arrow"):ha(Q,"arrow"),Q.style.left=y.left+"px",Q.style.top=y.top+"px",Q.style.width=y.width+"px",Q.style.height=y.height+"px",I&&P.classList.add("no-move")}else{var J=a.state.rotate||0;0==J?(R.style.left=y.left-2+"px",R.style.top=y.top-2+"px",R.style.width=y.width+4+"px",R.style.height=y.height+4+"px",R.style[k]="",R.style.display="block"):(R.style[k]="rotate("+J+"deg)",R.style.display="none"),Q.style.display="block",j<0?ha(Q,"iso-arrow"):b.getAttribute("data-zero")?ha(Q,"iso-arrow"):ha(Q,"widget"),Q.style.left=y.left+"px",Q.style.top=y.top+"px",Q.style.width=y.width+"px",Q.style.height=y.height+"px"}}Z(!!b)}function ka(a){var b=null,c=null;n&&a&&(b=n.componentOf(a))&&(c=b.getHtmlNode()),ja(b,c,a)}function la(a,b,c){function g(){var b=a.state["data-from"];if(b){var c=n.componentOf(b);if(!c)return;var g,i=c.state["svg.cfg"];if(Array.isArray(i)&&Array.isArray(g=i[1])){var j=g[1];if(Array.isArray(j)){var k=null;j.forEach(function(a){var b=a[0],c=a[2];if(b===f&&c&&b!=c){var d=n.componentOf(c);d&&(k=d)}}),k&&(ga(),setTimeout(function(){Fa(c,k)},100))}}}else{h.eachComponent(n,function(b){if(b!==a){var c,d=b.state["svg.cfg"];if(Array.isArray(d)&&Array.isArray(c=d[1])){var e=c[1];if(Array.isArray(e))for(var h,g=0;h=e[g];g++)h[2]===f&&Fa(b,a)}}});var g,i=(a.state.left,a.state.top,a.state["svg.cfg"]);if(Array.isArray(i)&&Array.isArray(g=i[1])){var j=g[1];Array.isArray(j)&&j.forEach(function(b){var c=b[2];if(c){var d=n.componentOf(c);d&&Fa(a,d)}})}}}var f="";a?(a.state.left,a.state.top,f=a.duals.keyid+"",setTimeout(function(){ja(a,a.getHtmlNode(),f),c&&setTimeout(g,100)},b)):ja(null,null,f)}function ma(a){uc(!0,!a,!1)}function na(a){if(n){for(var b=a.target,c=document.body,d=null;b&&b!==c;){if(b.classList.contains("popline-expand")){d=b;break}b=b.parentNode}d&&(K.clientHeight<100?(N.style.height="270px",K.style.height="270px",d.style[k]="rotate(90deg)"):(N.style.height=S+"px",K.style.height=S+"px",d.style[k]="rotate(270deg)"))}}function oa(a){n&&(n.duals.offsetX=0,n.duals.offsetY=0,y.innerHTML="(0,0)")}function pa(a){if(n){var b=a.target.checked,c=n.state.offsetX,d=n.state.offsetY;n.duals.style={backgroundRepeat:b?"repeat":"no-repeat",backgroundPosition:c%20+"px "+d%20+"px"}}}function wa(a){for(var b=document.body;a&&a!==b&&"DIV"!=a.nodeName;)a=a.parentNode;if(a&&a.parentNode===J){var c="rgba(0,0,0,0)";return a.querySelector("svg")||(c=window.getComputedStyle(a).backgroundColor),c}return""}function xa(a,b){if(n&&qa){var c=wa(a);if(c){if(!b){document.querySelector("#group-opacity");z.value="rgba(0,0,0,0)"==c?"0":"100"}var e={};b?(e.strokeColor=c,ra=c):(e.fillColor=c,sa=c);var f=n.componentOf(qa);f&&(f.duals.style=e)}}}function ya(a){for(;a&&"DIV"!=a.nodeName;)a=a.parentNode;if(a&&a.parentNode===J){if(!a.querySelector("svg")){document.querySelector("#color-dlg").style.display="block",V=a}}}function Ba(a){if(!(a.ctrlKey||a.altKey||a.metaKey)){var b=a.target,c=a.shiftKey,d=!1;a.timeStamp-za<300?(d=!0,Aa=za=a.timeStamp,ya(b)):(setTimeout(function(){if(!d&&Aa!=za){var e=null;if("none"!=N.style.display){var f,g=M.selectionStart;if("number"==typeof g&&g!=(f=M.selectionEnd)){var h=M.value;e=[h.slice(0,g),h.slice(g,f),h.slice(f)]}}var i,j;if(e&&(i=e[1])&&(j=wa(b))){a.stopPropagation();var k=/^#[0-9A-Fa-f]+$/,l=/^(rgb|rgba)\([ ,0-9]+\)$/;j=j.replace(/ /g,""),0==i.search(k)||0==i.search(l)?M.value=e[0]+j+e[2]:M.value=e[0]+'<span style="color:'+j+'">'+i+"</span>"+e[2],_()}else Y(),xa(b,c)}},300),za=a.timeStamp)}}function Ca(a){var b=a.target;if(V&&"TD"==b.nodeName){var c=b.getAttribute("bgcolor")||"#FFFFFF";V.style.backgroundColor=c}Y(),a.stopPropagation()}function Da(a,b,c,d){var e=c-a,f=d-b,g=Math.abs(e),h=Math.abs(f);if(0==g&&0==h)return 0;var i=Math.sqrt(g*g+h*h),j=Math.acos(h/i),k=180/(Math.PI/j);return e>0?f>0?90-k:270+k:f>0?90+k:270-k}function Ea(a,b,c,d){document.querySelector("div.free-transform");R.style.left=a-2+"px",R.style.top=b-2+"px",R.style.width=c+4+"px",R.style.height=d+4+"px",Q.style.left=a+"px",Q.style.top=b+"px",Q.style.width=c+"px",Q.style.height=d+"px"}function Fa(a,b,c){function Ha(a,b,c){return a>=c.left&&a<c.left+c.width&&b>=c.top&&b<c.top+c.height}var d,e=a.state["svg.cfg"];if(Array.isArray(e)&&Array.isArray(d=e[1])){var f=a.getHtmlNode(),g=b.getHtmlNode();if(f&&g){var i=a.duals.keyid+"",j=d[1];Array.isArray(j)||(d[1]=j=[]);var k=b.duals.keyid+"",o=p(f),q=p(g),r=!1;(Ha(o.left,o.top,q)||Ha(o.left+o.width-1,o.top,q)||Ha(o.left+o.width-1,o.top+o.height-1,q)||Ha(o.left,o.top+o.height-1,q))&&(r=!0);for(var A,s="",t="",u=ra,v=sa,w=ua,x=ta,y=va,z=0;A=j[z];z++){var B=A[2];if(B&&B===k){var C=A[0],D=n.componentOf(C);if(D){var E=D.state["svg.cfg"];if(Array.isArray(E)){w=D.state.stroke||3,u=D.state.style.strokeColor||"rgb(119,119,119)",v=D.state.style.fillColor||"rgb(119,119,119)";var F=E[1];Array.isArray(F)&&(x=F[0]||"",y=F[3],isNaN(y)&&(y=2))}if(r)3==A.length&&A.push([u,v,w,x,y]);else{var G=A[3];Array.isArray(G)&&(A.splice(3,1),u=G[0],v=G[1],w=G[2],x=G[3],y=G[4])}t="-"+C}void 0===c&&(c=-2==A[1]),s=A[0];break}}if(r)return void(t&&n.setChild(t));s||(T+=1,s="auto"+T,j.push([s,c?-2:-1,k]));var J=(o.width,o.height,o.left+o.width/2),K=o.top+o.height/2,L=Da(J,K,o.left+o.width,o.top+o.height),M=Da(J,K,o.left,o.top+o.height),N=Da(J,K,o.left,o.top),O=Da(J,K,o.left+o.width,o.top),R=(q.width,q.height,q.left+q.width/2),U=q.top+q.height/2,Z=(Da(R,U,q.left+q.width,q.top+q.height),Da(R,U,q.left,q.top+q.height),Da(R,U,q.left,q.top),Da(R,U,q.left+q.width,q.top),Math.floor(2.5*w+.5)),$=Z;Z*=l;var _,aa,ba,ca,da,ea,fa=0,ga=0,ha=-$,ia=-$,ja=a.props["data-zero"],ka=b.props["data-zero"];if(ja){_=J,aa=K;var la=o.width>=o.height,ma=!1,na=!1,oa=!1;R>=J?ka?(da=R,ea=U,Math.abs(ea-aa)<=Z&&(ma=!0,oa=!0),da-_<=Z&&(ma=!0,na=!0)):_>=q.left?(da=_,ea=U<K?q.top+q.height:q.top,ma=!0):la?aa>=q.top&&aa<q.top+q.height?(da=q.left,ea=aa,ma=!0):(da=R,ea=U<K?q.top+q.height:q.top,da-_<10&&(da=Math.min(q.left+q.width,_+20)),Math.abs(ea-aa)<=Z&&(da=q.left,ma=!0,oa=!0)):aa>=q.top&&aa<q.top+q.height?(da=q.left,ea=aa,ma=!0):(da=q.left,ea=U,U<K?aa-ea<10&&(ea=Math.max(q.top,aa-20)):ea-aa<10&&(ea=Math.min(q.top+q.height,aa+20)),Math.abs(da-_)<=Z&&(ea=U<K?q.top+q.height:q.top,ma=!0,na=!0)):ka?(da=R,ea=U,Math.abs(ea-aa)<=Z&&(ma=!0,oa=!0),_-da<=Z&&(ma=!0,na=!0)):_<q.left+q.width?(da=_,ea=U<K?q.top+q.height:q.top,ma=!0):la?aa>=q.top&&aa<q.top+q.height?(da=q.left+q.width,ea=aa,ma=!0):(da=R,ea=U<K?q.top+q.height:q.top,_-da<10&&(da=Math.max(q.left,_-20)),Math.abs(ea-aa)<=Z&&(da=q.left+q.width,ma=!0,oa=!0)):aa>=q.top&&aa<q.top+q.height?(da=q.left+q.width,ea=aa,ma=!0):(da=q.left+q.width,ea=U,U<K?aa-ea<10&&(ea=Math.max(q.top,aa-20)):ea-aa<10&&(ea=Math.min(q.top+q.height,aa+20)),Math.abs(da-_)<=Z&&(ea=U<K?q.top+q.height:q.top,ma=!0,na=!0)),ma?(ba=(_+da)/2,ca=(aa+ea)/2):c?la?(ba=_+3*(da-_)/5,ca=aa+(ea-aa)/5):(ba=_+(da-_)/5,ca=aa+3*(ea-aa)/5):la?(ba=da,ca=aa):(ba=_,ca=ea),ma?(na&&(ha=0),oa&&(ia=0),ea<aa&&!oa&&(ga=$),da<_&&!na&&(fa=$)):la?(ha=0,ea<aa&&(ga=$)):(ia=0,da<_&&(fa=$))}else{var pa=Da(J,K,R,U);pa>O&&pa<=360||pa>=0&&pa<=L?U>=o.top&&U<o.top+o.height?(_=o.left+o.width,aa=U,da=ka?R:q.left,ea=U,ba=(_+da)/2,ca=U):(ia=0,da=ka?R:q.left,ea=U,pa>O&&pa<=360?(_=J,aa=o.top,!ka&&aa-ea<10&&(ea=Math.max(q.top,aa-20))):(_=J,aa=o.top+o.height,!ka&&ea-aa<10&&(ea=Math.min(q.top+q.height,aa+20))),c?(ba=_+(da-_)/5,ca=aa+3*(ea-aa)/5):(ba=_,ca=ea)):pa>L&&pa<=M?R>=o.left&&R<o.left+o.width?(_=R,aa=o.top+o.height,da=R,ea=ka?U:q.top,ba=R,ca=(aa+ea)/2):(ha=0,da=R,ea=ka?U:q.top,pa<=90?(_=o.left+o.width,aa=K,!ka&&da-_<10&&(da=Math.min(q.left+q.width,_+20))):(_=o.left,aa=K,!ka&&_-da<10&&(da=Math.max(q.left,_-20))),c?(ba=_+3*(da-_)/5,ca=aa+(ea-aa)/5):(ba=da,ca=aa)):pa>M&&pa<=N?U>=o.top&&U<o.top+o.height?(_=o.left,aa=U,da=ka?R:q.left+q.width,ea=U,ba=(_+da)/2,ca=U,fa=$):(ia=0,da=ka?R:q.left+q.width,ea=U,pa<=180?(_=J,aa=o.top+o.height,!ka&&ea-aa<10&&(ea=Math.min(q.top+q.height,aa+20)),fa=$):(_=J,aa=o.top,!ka&&aa-ea<10&&(ea=Math.max(q.top,aa-20)),fa=$),c?(ba=_+(da-_)/5,ca=aa+3*(ea-aa)/5):(ba=_,ca=ea)):R>=o.left&&R<o.left+o.width?(_=R,aa=o.top,da=R,ea=ka?U:q.top+q.height,ba=R,ca=(aa+ea)/2,ha=0,ga=$):(ha=0,da=R,ea=ka?U:q.top+q.height,pa<=270?(_=o.left,aa=K,!ka&&_-da<10&&(da=Math.max(q.left,_-20)),ga=$):(_=o.left+o.width,aa=K,!ka&&da-_<10&&(da=Math.min(q.left+q.width,_+20)),ga=$),c?(ba=_+3*(da-_)/5,ca=aa+(ea-aa)/5):(ba=da,ca=aa))}_=Math.floor(_+.5),aa=Math.floor(aa+.5),ba=Math.floor(ba+.5),ca=Math.floor(ca+.5),da=Math.floor(da+.5),ea=Math.floor(ea+.5);var qa=Math.min(_,da),wa=Math.min(aa,ea),xa=qa-Z+fa,ya=wa-Z+ga-S,za=Z+Z+1,Aa=Math.max(Math.abs(da-_)+Z+Z+ha,za),Ba=Math.max(Math.abs(ea-aa)+Z+Z+ia,za),Ca=n.state.offsetX||0,Ea=n.state.offsetY||0,d=[x,0,0,y,_-qa,aa-wa,ba-qa,ca-wa,da-qa,ea-wa],Fa=[c?-2:-1,d,m],Ga=h.loadElement(["rewgt.SvgPanel",{key:s,klass:"nowrap-default-wrap_reverse items_center-end-stretch-default",left:xa-Ca,top:ya-Ea,width:Aa,height:Ba,style:{strokeColor:u,fillColor:v,zIndex:"-1"},stroke:w,"svg.cfg":Fa,"data-from":i}]);t?n.setChild(t,function(a){n.setChild(Ga)}):n.setChild(Ga)}}}function Ya(a){function c(a,c){var d=null,e=-999;return h.eachComponent(n,function(f){var g=f.getHtmlNode();if(g){var h=p(g);if(a>=h.left&&a<h.left+h.width&&c>=h.top&&c<h.top+h.height){if(f.state["data-from"])return void(b=!0);var i=parseInt(g.style.zIndex||"0");(!d||i>=e)&&(e=i,d=f)}}}),d}var b=!1;if(n&&!(a.ctrlKey||a.shiftKey||a.altKey||a.metaKey)){a.stopPropagation();var d=!1;if(!qa){var e=c(a.clientX,a.clientY);e&&(la(e,0,!1),qa=e.duals.keyid+""),d=!0}var f,g=null;if(qa&&(f=n.componentOf(qa))){var i=f.getHtmlNode();if(f.state["data-from"])b=!0;else if(i){var j=p(i),k=a.clientX,l=a.clientY;k>=j.left&&k<j.left+j.width&&l>=j.top&&l<j.top+j.height&&(g=f)}}if(qa&&!g&&!d){var e=c(a.clientX,a.clientY);e&&(la(e,0,!1),qa=e.duals.keyid+"",g=e)}g&&(Oa=g,Pa=!1,Qa=[],Ra=[],Sa=k,Ta=l,Ua=g.state.left,Va=g.state.top,setTimeout(function(){Q.style.display="none",P.style.display="none",R.style.display="none"},0)),g||qa||b||(Ga=O,Ha=!1,Ka=Ia=a.clientX,La=Ja=a.clientY,Ma=n.state.offsetX,Na=n.state.offsetY,n.duals.style={cursor:"pointer"})}}function Za(a){var b="-"+a.duals.keyid;setTimeout(function(){n.setChild(b)},100)}function $a(a,b,c,d,e,f,g){a.duals.left=d,a.duals.top=e,a.reRender(function(){b.forEach(function(b){Fa(b,a)}),c.forEach(function(b){var c=b[0];3==b.length?(c.duals.left=b[1]+f,c.duals.top=b[2]+g):Fa(a,c)})})}function _a(a){function ia(a,b,c){"none"!=a.style.display&&(a.style.left=parseFloat(a.style.left)+b+"px",a.style.top=parseFloat(a.style.top)+c+"px")}if(n){var b=a.clientX,c=a.clientY;if(Oa){var d=b-Sa,e=c-Ta;if(!Pa&&(Math.abs(d)>5||Math.abs(e)>5)){Pa=!0;var f=Oa.duals.keyid+"";h.eachComponent(n,function(a){if(a!==Oa){var b,c=a.state["svg.cfg"];if(Array.isArray(c)&&Array.isArray(b=c[1])){var d=b[1];if(Array.isArray(d))for(var g,e=0;g=d[e];e++)g[2]===f&&Qa.push(a)}}});var g,i=Oa.state["svg.cfg"];if(Array.isArray(i)&&Array.isArray(g=i[1])){var j=g[1];Array.isArray(j)&&j.forEach(function(a){var b=a[0],c=a[2];if(c){var d=n.componentOf(c);d&&Ra.push([d])}else{var d=n.componentOf(b);d&&Ra.push([d,d.state.left,d.state.top])}})}}Pa&&$a(Oa,Qa,Ra,Ua+d,Va+e,d,e)}else if(Ga){var d=b-Ia,e=c-Ja;if(Ha||(Math.abs(d)>5||Math.abs(e)>5)&&(Ha=!0),Ha){var o=Ma+d,q=Na+e;n.duals.offsetX=o,n.duals.offsetY=q,n.duals.style={backgroundPosition:o%20+"px "+q%20+"px"},y.innerHTML="("+o+","+q+")";var r=b-Ka,s=c-La;Ka=b,La=c,ia(P,r,s),ia(R,r,s),ia(Q,r,s)}}else if(zb){var d=b-Ab,e=c-Bb;zb.duals.left=Cb+d,zb.duals.top=Db+e}else if(ac){var d=b-dc,e=c-ec;bc.duals.left=fc+d,bc.duals.top=gc+e}else if(Gb){var t=Gb.getHtmlNode();if(t){var u=p(t),v=Da(u.left+u.width/2,u.top+u.height/2,b,c),w=(Hb+v-Ib)%360;w<0&&(w+=360),Gb.duals.rotate=w,R.style[k]=0==w?"":"rotate("+w+"deg)"}}else if(Kb){var d=b-Mb,e=c-Nb,x=Ob.left-(n.state.offsetX||0),z=Ob.top-S-(n.state.offsetY||0);if("top-left"==Lb){var A=Ob.width-d,B=Ob.height-e;A>=12&&B>=12&&(Kb.duals.left=x+d,Kb.duals.top=z+e,Kb.duals.width=A,Kb.duals.height=B,Ea(Ob.left+d,Ob.top+e,A,B))}else if("top"==Lb){var B=Ob.height-e;B>=12&&(Kb.duals.top=z+e,Kb.duals.height=B,Ea(Ob.left,Ob.top+e,Ob.width,B))}else if("top-right"==Lb){var A=Ob.width+d,B=Ob.height-e;A>=12&&B>=12&&(Kb.duals.top=z+e,Kb.duals.width=A,Kb.duals.height=B,Ea(Ob.left,Ob.top+e,A,B))}else if("right"==Lb){var A=Ob.width+d;A>=12&&(Kb.duals.width=A,Ea(Ob.left,Ob.top,A,Ob.height))}else if("bottom-right"==Lb){var A=Ob.width+d,B=Ob.height+e;A>=12&&B>=12&&(Kb.duals.width=A,Kb.duals.height=B,Ea(Ob.left,Ob.top,A,B))}else if("bottom"==Lb){var B=Ob.height+e;B>=12&&(Kb.duals.height=B,Ea(Ob.left,Ob.top,Ob.width,B))}else if("bottom-left"==Lb){var A=Ob.width-d,B=Ob.height+e;A>=12&&B>=12&&(Kb.duals.left=x+d,Kb.duals.width=A,Kb.duals.height=B,Ea(Ob.left+d,Ob.top,A,B))}else if("left"==Lb){var A=Ob.width-d;A>=12&&(Kb.duals.left=x+d,Kb.duals.width=A,Ea(Ob.left+d,Ob.top,A,Ob.height))}}else if(Ub){var t=Ub.getHtmlNode();if(!t)return;var C,D,E="";if(Wb)C=Xb,D=Yb;else{var u=p(t);if(b>=u.left&&b<=u.left+u.width&&c>=u.top&&c<=u.top+u.height)return;if(Math.abs(b-Zb)<20&&Math.abs(c-$b)<20)return;var G,H,F=Ub.state["data-zero"],I=u.left+u.width/2,J=u.top+u.height/2,K=u.width/2,L=u.height/2;if(F)E="center,0",G=I,H=J,C=Math.floor(G+.5),D=Math.floor(H+.5);else{var v=Da(I,J,u.left+u.width,u.top+u.height),w=Da(I,J,u.left,u.top+u.height),M=Da(I,J,u.left,u.top),N=Da(I,J,u.left+u.width,u.top),O=Da(I,J,b,c);O>N&&O<=360||O>=0&&O<=v?(E="right",G=I+K,H=c>u.top+2&&c<u.top+u.height-2?c:J+K*(c-J)/(b-I)):O>v&&O<=w?(E="bottom",H=J+L,G=b>u.left+2&&b<u.left+u.width-2?b:I+L*(b-I)/(c-J)):O>w&&O<=M?(E="left",G=u.left,H=c>u.top+2&&c<u.top+u.height-2?a.clientY:J+K*(c-J)/(I-b)):(E="top",H=u.top,G=b>u.left+2&&b<u.left+u.width-2?b:I+L*(b-I)/(J-c)),C=Math.floor(G+.5),D=Math.floor(H+.5),E+="right"==E||"left"==E?","+(D-S):","+C}}var U=Math.floor(2.5*ua+.5);U*=l;var V=Math.min(b,C),W=Math.min(c,D),o=V-U,q=W-U-S,X=U+U+1,Y=Math.max(Math.abs(b-C)+U+U,X),Z=Math.max(Math.abs(c-D)+U+U,X),g=[ta,0,0,va,C-V,D-W,b-V,c-W],$=[Vb?-2:-1,g,m];if(Wa&&(Xa===Ub?(Wa.duals.left=o-(n.state.offsetX||0),Wa.duals.top=q-(n.state.offsetY||0),Wa.duals.width=Y,Wa.duals.height=Z,Wa.duals["data-align"]=E,Wa.duals["svg.cfg"]=$):(Za(Wa),Wa=null,Xa=null)),!Wa){T+=1;var _="auto"+T,aa=h.loadElement(["rewgt.SvgPanel",{key:_,klass:"nowrap-default-wrap_reverse items_center-end-stretch-default",left:o-(n.state.offsetX||0),top:q-(n.state.offsetY||0),width:Y,height:Z,style:{strokeColor:ra,fillColor:sa,zIndex:"-1"},stroke:ua,"svg.cfg":$,"data-align":E,"data-from":""}]);n.setChild(aa,function(a){var b=n.componentOf(_);b&&(Wa=b,Xa=Ub)})}}else if(ic){var t=ic.getHtmlNode();if(t&&jc&&"block"==P.style.display){var ba=ic.state["svg.cfg"];if(Array.isArray(ba)&&Array.isArray(subCfg=ba[1])){var d=b-mc,e=c-nc,ca=parseInt(jc.getAttribute("_pos")||"1"),da=ca+ca+5;if(da<subCfg.length){ba=ba.slice(0),ba[1]=subCfg=subCfg.slice(0);var ea=ic.state.stroke,fa=P.rateX||1,ga=P.rateY||1,u=p(t);subCfg[da-1]=kc+d/fa,subCfg[da]=lc+e/ga;var ha=ab(u,subCfg,ea,fa,ga);ic.duals.left=ha[0],ic.duals.top=ha[1],ic.duals.width=ha[2],ic.duals.height=ha[3],ic.duals["svg.cfg"]=ba,jc.style.left=oc+d+"px",jc.style.top=pc+e+"px"}}}}}}function ab(a,b,c,d,e){var f=Math.floor(2.5*c+.5);f*=l;for(var g=65535,h=65535,i=0,j=0,k=b.length,m=5;m<k;m+=2){var o=b[m-1],p=b[m];o<g&&(g=o),p<h&&(h=p)}for(var m=5;m<k;m+=2){var o=b[m-1]-g,p=b[m]-h;b[m-1]=o,b[m]=p,o>i&&(i=o),p>j&&(j=p)}kc-=g,lc-=h;var q=Math.floor(a.left+g*d+.5)-(n.state.offsetX||0),r=Math.floor(a.top+h*e+.5)-S-(n.state.offsetY||0),s=f+f+1;return[q,r,Math.floor(Math.max(i*d+f+f,s)+.5),Math.floor(Math.max(j*e+f+f,s)+.5)]}function bb(a){function C(a,b){var c=a-b,d=4*Math.floor(c/4),e=c-d;return e>2?d+=4:e<-2&&(d-=4),d+b}function D(a){var b=4*Math.floor(a/4);return a-b>2?b+4:b}if(n){a.stopPropagation();var b=!0;if(Oa){if(Pa){b=!1;var c=n.state.offsetX||0,d=n.state.offsetY||0,e=C(a.clientX,c)-Sa,f=C(a.clientY,d)-Ta;$a(Oa,Qa,Ra,Ua+e,Va+f,e,f),la(Oa,100,!1)}Pa=!1,Qa=[],Ra=[]}else if(Ga)Ha&&(b=!1),n.duals.style={cursor:""},Ha=!1;else if(zb)b=!1,setTimeout(function(a){a.duals.left=C(a.state.left,0),a.duals.top=C(a.state.top,0)},0,zb);else if(ac)b=!1,setTimeout(function(a,b){b.duals.left=C(b.state.left,0),b.duals.top=C(b.state.top,0),b.reRender(function(){Fa(a,b,cc)})},0,ac,bc),bc=null;else if(Gb){b=!1;var g=Gb.getHtmlNode();if(g){var i=Gb.state.rotate||0;if(0!=i){var j=15*Math.floor(i/15);i!=j&&(i=i-j<7.5?j:(j+15)%360)}Gb.duals.rotate=i,R.style[k]=0==i?"":"rotate("+i+"deg)"}la(Gb,100,!0)}else if(Kb){b=!1;var g=Kb.getHtmlNode(),l=g&&p(g);if(l){var m=l.left,o=l.top-S,q=l.width,r=l.height;"top-left"==Lb?(Kb.duals.left=C(m-(n.state.offsetX||0),0),Kb.duals.top=C(o-(n.state.offsetY||0),0),Kb.duals.width=D(q),Kb.duals.height=D(r)):"top"==Lb?(Kb.duals.top=C(o-(n.state.offsetY||0),0),Kb.duals.height=D(r)):"top-right"==Lb?(Kb.duals.top=C(o-(n.state.offsetY||0),0),Kb.duals.width=D(q),Kb.duals.height=D(r)):"right"==Lb?Kb.duals.width=D(q):"bottom-right"==Lb?(Kb.duals.width=D(q),Kb.duals.height=D(r)):"bottom"==Lb?Kb.duals.height=D(r):"bottom-left"==Lb?(Kb.duals.left=C(m-(n.state.offsetX||0),0),Kb.duals.width=D(q),Kb.duals.height=D(r)):"left"==Lb&&(Kb.duals.left=C(m-(n.state.offsetX||0),0),Kb.duals.width=D(q))}la(Kb,100,!0)}else if(Ub){if(b=!1,Wb){var g=Ub.getHtmlNode(),e=a.clientX-Xb,f=a.clientY-Yb;if(g&&(Math.abs(e)>=4||Math.abs(f)>=4)){var l=p(g);setTimeout(function(a,b,c){var d,g=a.state["svg.cfg"],h=a.state.stroke;if(Array.isArray(g)&&Array.isArray(d=g[1])){g=g.slice(0),d=d.slice(0),g[1]=d;var i=d[d.length-2],j=d[d.length-1];d.push(i+e/b,j+f/c);var k=ab(l,d,h,b,c);a.duals.left=k[0],a.duals.top=k[1],a.duals.width=k[2],a.duals.height=k[3],a.duals["svg.cfg"]=g,la(a,100,!1)}},100,Ub,P.rateX,P.rateY)}}else if(Wa){var s=a.clientX,t=a.clientY,u=null,v=-999;h.eachComponent(n,function(a){if(a!==Ub){var b=a.state["data-align"],c=a.getHtmlNode();if(!b&&c){var d=p(c),e=d.width/10,f=d.height/10;if(s>=d.left+e&&s<d.left+d.width-e&&t>=d.top+f&&t<d.top+d.height-f){var g=parseInt(c.style.zIndex||"0");g>=v&&(u=a,v=g)}}}}),u?Fa(Ub,u,Vb):(setTimeout(function(a,b){b.duals["data-from"]=a.duals.keyid+"";var c=a.state["svg.cfg"];if(Array.isArray(c)&&c.length>=2){var d=b.duals.keyid+"",e=c[1],f=e[1];Array.isArray(f)||(e[1]=f=[]),f.push([d,Vb?-2:-1])}},100,Ub,Wa),Wa=null,Xa=null)}Wa&&(Za(Wa),Wa=null,Xa=null)}else ic&&(b=!1,la(ic,100,!0),jc=null);var w=null;if(b){var y=a.target;if(y===N)!0;else{for(var z=document.body,A=!1,B=null;y&&y!==z;){if(y===O){A=!0;break}y.classList.contains("rewgt-paperview")&&(w=B),B=y,y=y.parentNode}A||(b=!1,w=null)}}b&&(Y(),w&&(qa=h.keyOfNode(w))?ka(qa):ga()),Ga=null,Oa=null,zb=null,ac=null,Gb=null,Kb=null,Ub=null,ic=null}}function cb(a){if(n&&!(a.ctrlKey||a.altKey||a.metaKey)){var b=a.shiftKey,c=b&&38==a.keyCode,d=b&&40==a.keyCode;if(c||d){var e=[];if(h.eachComponent(n,function(a){var b=a.getHtmlNode();if(b){var c=p(b);e.push([c.top,c.left,a,a.duals.keyid+""])}}),e.length){e.sort(function(a,b){var c=a[0],d=b[0];return c==d?a[1]>b[1]?1:-1:c>d?1:-1});var f=0;if(qa){var g=e.findIndex(function(a){return a[3]===qa});g>=0&&(c?f=g>0?g-1:e.length-1:(f=g+1)==e.length&&(f=0))}var i=e[f];ga(),setTimeout(function(){qa=i[3],la(i[2],100,!1)},100)}}}}function db(a){var e,f,b=a.target,c=p(b),d=c.height/2,g=a.clientX-c.left,h=a.clientY-c.top;c.width-g<18?(e=h>d?"100% -36px":"100% -18px",f="default"):(e="100% 0px",f="auto"),b.style.backgroundPosition=e,b.style.cursor=f}function eb(a){a.target.style.backgroundPosition="100% 0px"}function fb(a,b,c){var d=a.componentOf(b);if(d){var e,f=X((d.state.style.fillColor||"").trim());f&&f.length>=3&&(e=100==c?"rgb("+f[0]+","+f[1]+","+f[2]+")":"rgba("+f[0]+","+f[1]+","+f[2]+","+(c/100).toPrecision(2)+")",d.duals.style={fillColor:e})}}function gb(a){if(n&&qa){var b=a.target,c=p(b),d=c.height/2,e=a.clientX-c.left,f=a.clientY-c.top;if(c.width-e<18){var g=parseInt(b.value)||0,h=5*Math.floor(g/5);f>d?(g!=h?g=h:g-=5,g<0&&(g=0)):(g!=h?g=h+5:g+=5,g>100&&(g=100)),b.value=g+"",fb(n,qa,g)}}}function hb(a){if(n&&qa){var b=a.target,c=parseInt(b.value)||0;c=Math.max(0,Math.min(100,c)),c+""!==b.value&&setTimeout(function(){b.value=c+""},0),fb(n,qa,c)}}function ib(a,b,c){var d=a.componentOf(b);d&&(d.duals.stroke=ua=c||3,la(d,100,!0))}function jb(a){if(n&&qa){var b=a.target,c=p(b),d=c.height/2,e=a.clientX-c.left,f=a.clientY-c.top;if(c.width-e<18){var g=parseInt(b.value);f>d?g>=2&&(g-=1):g<360&&(g+=1),b.value=g+"",ib(n,qa,g)}}}function kb(a){if(n&&qa){var b=a.target,c=parseInt(b.value)||3;c=Math.max(1,Math.min(360,c)),c+""!==b.value&&setTimeout(function(){b.value=c+""},0),ib(n,qa,c)}}function pb(a,b){n&&qa&&setTimeout(function(){lb=b,I.style.display="block"},10)}function qb(a){if(n&&qa){for(var b=a.target;b&&"svg"!=b.nodeName;)b=b.parentNode;if(b){var c,e,d=parseInt(b.getAttribute("_style")||"1"),f=n.componentOf(qa);if(f&&Array.isArray(e=f.state["svg.cfg"])){var g=(e[1]||[]).slice(0);0==g.length&&g.push(""),1==g.length&&g.push(0),2==g.length&&g.push(1),c=lb?nb[d]||nb[0]:mb[d]||mb[1];var h='<svg width="18" height="18" viewBox="0 0 100 100"><path stroke="#ff7f00" fill="#ff7f00" stroke-width="10" d="';h+=c+'"/></svg>';var i,j=3;lb?(j=2,i=B):(i=C,va=d+1),i.innerHTML=h,g[j]=lb&&0==d?0:d+1,e=e.slice(0),e[1]=g,f.duals["svg.cfg"]=e}}}}function rb(a){n&&qa&&setTimeout(function(){H.style.display="block"},10)}function sb(a){if(n&&qa){for(var b=a.target;b&&"svg"!=b.nodeName;)b=b.parentNode;if(b){var c,d=n.componentOf(qa);if(d&&Array.isArray(c=d.state["svg.cfg"])){var e=(c[1]||[]).slice(0),f=parseInt(b.getAttribute("_style")||"0"),g=ob[f]||"",h='<svg width="60" height="14"><line stroke="#ff7f00" stroke-width="1" ';g&&(h+='stroke-dasharray="'+g+'" '),h+='x1="0%" y1="60%" x2="100%" y2="60%"/></svg>',D.innerHTML=h,e[0]=g,c=c.slice(0),c[1]=e,c[0]<0&&(ta=g),d.duals["svg.cfg"]=c}}}}function tb(a,b){if(n&&qa){var c=n.componentOf(qa+".txt");if(c){var d=0==b?"default-align_center-right":1==b?"align_center-right-default":"right-default-align_center";h.mergeClass(c,d)}}}function ub(a){if(n&&qa){var b=n.componentOf(qa);if(b){var c=parseInt(b.state.style.zIndex||"0"),d=-999;h.eachComponent(n,function(a){if(b!==a){var c=parseInt(a.state.style.zIndex||"0");c>d&&(d=c)}}),c>d||(b.duals.style={zIndex:Math.min(999,d+1)+""})}}}function vb(a){if(n&&qa){var b=n.componentOf(qa);if(b){var c=parseInt(b.state.style.zIndex||"0"),d=999;h.eachComponent(n,function(a){if(b!==a){var c=parseInt(a.state.style.zIndex||"0");c<d&&(d=c)}}),c<d||(b.duals.style={zIndex:Math.max(-999,d-1)+""})}}}function wb(a){if(n&&qa){var b=n.componentOf(qa);if(b){var c=qa;ga();var d=[];h.eachComponent(n,function(a){if(a!==b){var e,f=a.state["svg.cfg"];if(Array.isArray(f)&&Array.isArray(e=f[1])){var g=e[1];if(Array.isArray(g))for(var h=g.length-1;h>=0;h--){var i=g[h],j=i[0],k=i[2];k===c?(d.push("-"+j),g.splice(h,1)):j===c&&g.splice(h,1)}}}});var e=b.state["svg.cfg"];if(Array.isArray(e)){var f,g=e[1];if(Array.isArray(g)&&Array.isArray(f=g[1]))for(var j,i=0;j=f[i];i++)d.push("-"+j[0])}d.push("-"+c),n.setChild.apply(n,d)}}}function yb(a){function j(a,b){for(var c=a.split(/ +/),d=c.length-1;d>=0;){var e=c[d];xb.indexOf(e)>=0&&(b&&(f=e),c.splice(d,1)),d-=1}return c.join(" ")}if(n&&qa){var b=n.componentOf(qa),c=b&&b.componentOf("txt");if(c){var f="",g=(c.state.klass||"").trim();g=j(g,!0);var h=window.prompt("Modify klass",g);if("string"==typeof h&&(h=j(h.trim(),!1),f&&(h=f+" "+h),(h=h.trim())!==c.state.klass)){var i=b.elementOf("txt");if(!i||!i.props["marked."])return;i=d.cloneElement(i,{"html.":c.state["html."]||"",klass:h}),b.setChild("-txt",function(a){b.setChild(i)})}}else if(b){var e=window.prompt("Input text","text");"string"==typeof e&&(b.duals["html."]=e.trim(),ga())}}}function Eb(a,b,c,e){var f=a.state["svg.cfg"],g={key:c,left:a.state.left+4,top:a.state.top+4,width:a.state.width,height:a.state.height,rotate:a.state.rotate,stroke:a.state.stroke,style:{strokeColor:a.state.style.strokeColor||"#888",fillColor:a.state.style.fillColor||"#eee"}};if(Array.isArray(f)){f=f.slice(0);var h=f[1];Array.isArray(h)&&(f[1]=h=h.slice(0),h.length>=2&&(h[1]=0)),g["svg.cfg"]=f}var i=null,j=a.componentOf("txt");if(j&&1==a.$gui.comps.length){var k=a.$gui.comps[0];k&&k.props["marked."]&&(k=d.cloneElement(k,{"hookTo.":void 0,"html.":j.state["html."]||""}),g["html."]="",i=d.cloneElement(b,g,k))}i||(i=d.cloneElement(b,g)),n.setChild(i,function(a){a&&e()})}function Fb(a){if(!(a.ctrlKey||a.shiftKey||a.altKey||a.metaKey)&&n&&qa){var b=n.componentOf(qa),c=n.elementOf(qa);if(b&&c){T+=1;var d="auto"+T,e=a.clientX,f=a.clientY;Eb(b,c,d,function(){var a=n.componentOf(d);a&&(zb=a,Ab=e+4,Bb=f+4,Cb=a.state.left,Db=a.state.top)})}}}function Jb(a){if(!(a.ctrlKey||a.shiftKey||a.altKey||a.metaKey)&&n&&qa){var b=n.componentOf(qa);if(b){var c=b.getHtmlNode();if(c){var d=p(c);Gb=b,Hb=b.state.rotate||0,Ib=Da(d.left+d.width/2,d.top+d.height/2,a.clientX,a.clientY)}}}}function Pb(a){if(!(a.ctrlKey||a.shiftKey||a.altKey||a.metaKey)&&n&&qa){var b=n.componentOf(qa);if(b){var c,d=a.target;d.classList.contains("resize")&&(c=b.getHtmlNode())&&(P.style.display="none",Kb=b,Lb=d.getAttribute("data-position"),Mb=a.clientX,Nb=a.clientY,Ob=p(c))}}}function Qb(a,b){if(!a.types)return!1;var c,d=a.types.length;for(c=0;c<d;c+=1)if(a.types[c]==b)return!0;return!1}function Rb(a){n&&Qb(a.dataTransfer,"application/json")&&a.preventDefault()}function Sb(a,b){var c=null;window.XMLHttpRequest?c=new XMLHttpRequest:window.ActiveXObject&&(c=new ActiveXObject("Microsoft.XMLHTTP")),c&&(c.onreadystatechange=function(){4==c.readyState&&(200==c.status?b(null,c.responseText):b(new Error("XMLHttpRequest failed")),c=null)},c.open("GET",a,!0),c.send(null))}function Tb(a){function s(){var a=r.scene,b=!1,c=100,e=60;if(Array.isArray(a)){var f=a[0];if(Array.isArray(f)&&"rewgt.DrawPaper"===f[0]){var g=f[1]||{};c=g.width||c,e=g.height||e,b=!0,a=a[1]}}else a=r.widget;if(Array.isArray(a)){var i=h.loadElement(a);if(i){if(!i.props["svg.cfg"]){var j=(i.props.className||"").split(/ +/);if(j.indexOf("rewgt-panel")<0&&j.indexOf("rewgt-unit")<0||i.props["drawPaper."]||i.props["isScenePage."])return void alert("Error: invalid widget type!");var k=a.slice(0);"string"==typeof k[0]&&(k=[k]);var l=k[0],m=l[1];m||(l[1]=m={}),delete m["data-group.optid"];var o=m.width,s=m.height;m.width=.9999,m.height=.9999,c=isNaN(o)||o<12?c:o,e=isNaN(s)||s<12?e:s,b=!0;var t=da(k,0,1);i=h.loadElement(["rewgt.SvgPanel",{klass:"nowrap-default-wrap_reverse items_center-end-stretch-default","html.":t,left:0,top:0,width:100,height:60,style:{strokeColor:"rgba(0,0,0,0)",fillColor:"rgba(0,0,0,0)"},"svg.cfg":[0,[],"lib/res/rect2.svg.json"]}])}T+=1;var u={left:p,top:q,key:"auto"+T};if(b)u.width=c,u.height=e;else{var o=i.props.width,s=i.props.height;u.width=isNaN(o)||o<12?c:o,u.height=isNaN(s)||s<12?e:s}i=d.cloneElement(i,u),n.setChild(i)}}}if(n&&Qb(a.dataTransfer,"application/json")){a.stopPropagation(),a.preventDefault();var b=null,c=a.dataTransfer.getData("application/json")||"{}";try{b=JSON.parse(c)}catch(a){console.log(a)}if(b)if("image"!=b.dragType){if("template"==b.dragType){var m=n.state.offsetX||0,o=n.state.offsetY||0,p=a.clientX-m,q=a.clientY-S-o,r=b.option;if("object"!=typeof r){if(void 0===r&&b.dragUrl){var g=b.dragUrl+".json";Sb(g,function(a,b){if(a)alert("error: read JSON failed ("+g+").");else{try{r=JSON.parse(b)}catch(a){alert("error: parse JSON failed ("+g+").")}r&&r.name&&s()}})}}else r.name&&s()}}else{var e,f=qa&&n.componentOf(qa+".txt");if(f&&(e=f.state.style.background)){var g=b.dragUrl;b.clientWidth,b.clientHeight;if(!g)return;0==g.indexOf(j)&&g.length>j.length&&(g=g.slice(j.length));var l="url("+g+")";e=e.replace(/\burl\([^)]+\)/,"").trim(),e&&(l+=" "+e),f.duals.style={background:l}}}}}function _b(a){if(n&&qa&&!(a.ctrlKey||a.altKey||a.metaKey)){var b=n.componentOf(qa);if(b){var c=b.getHtmlNode(),d=b.state["svg.cfg"];if(c&&Array.isArray(d)){var e;if(Wb=!1,"block"==P.style.display&&Array.isArray(e=d[1])){var f=p(c),g=b.state.stroke||3,h=Math.floor(2.5*g+.5);h*=l,Wb=!0,Xb=f.left+h+e[e.length-2]*P.rateX,Yb=f.top+h+e[e.length-1]*P.rateY}Ub=b,Vb=a.shiftKey,Zb=a.clientX,$b=a.clientY}}}}function hc(a){if(n&&qa&&!(a.ctrlKey||a.altKey||a.metaKey)){var b=n.componentOf(qa),c=n.elementOf(qa);if(b&&c){T+=1;var d="auto"+T,e=a.clientX,f=a.clientY,g=a.shiftKey;Eb(b,c,d,function(){var a=n.componentOf(d);a&&(cc=g,ac=b,bc=a,dc=e+4,ec=f+4,fc=a.state.left,gc=a.state.top)})}}}function qc(a){if(n&&qa){var b=a.target;if(b.classList.contains("pointer")){var c=b.parentNode;if("block"==c.style.display&&!c.classList.contains("no-move")){var d=n.componentOf(qa);if(d){var e,f=d.state["svg.cfg"];if(Array.isArray(f)&&Array.isArray(e=f[1])){var g=parseInt(b.getAttribute("_pos")||"1"),h=g+g+5;h<e.length&&(kc=e[h-1],lc=e[h],ic=d,jc=b,mc=a.clientX,nc=a.clientY,oc=parseInt(b.style.left),pc=parseInt(b.style.top))}}}}}}function uc(a,b,c){function g(){if(!i.containNode_)return null;var a=[],b=n.widget;if(i.containNode_.dumpTree(a,b,b.parent.getPath()),Array.isArray(a)&&a.length){var c=a[0];if(!Array.isArray(c))return null;var d=c[0];if("rewgt.DrawPaper"===d)return[c];if(Array.isArray(d)){if(d.length>=2){var e=d[1];e.offsetX=n.state.offsetX,e.offsetY=n.state.offsetY}return c}}return null}var d=null,e=!0;!b&&tc&&n?(d=g(),Array.isArray(d)||(alert("Error: setup paper data failed"),d=null,e=!1)):e=!1;var f="[PROJECT_NAME]"+JSON.stringify({method:"onDialogExit",param:[a,e,rc,[e,sc,d]]});window.parent.window.postMessage(f,"*")}function vc(a,b,c){function l(){if(g>120)return void console.log("fatal error: load shadow-widget failed");g+=1,n?p():setTimeout(l,500)}function m(a,b){var c=a.length,d=0;c?a.forEach(function(a){var e=document.createElement("link");"onload"in e?(b&&(e.onload=function(a){(d+=1)>=c&&b()}),e.setAttribute("rel","stylesheet"),e.setAttribute("href",a),document.head.appendChild(e)):(e=document.createElement("img"),b&&(e.onerror=function(a){(d+=1)>=c&&b()}),e.setAttribute("src",a),document.body.appendChild(e))}):b&&b()}function p(){m(c,function(){rc=a,sc=e,tc=f;var b=h.loadElement(f),c=b.props,g=d.Children.toArray(c.children),i=c.offsetX||0,j=c.offsetY||0;o=c.defId||"pp0",y.innerHTML="("+i+","+j+")",c.klass&&h.mergeClass(n,c.klass);var k=Object.assign({},c.style,{backgroundImage:"url(output/papergrid.png)",backgroundRepeat:"no-repeat",backgroundPosition:i%20+"px "+j%20+"px"});n.duals.style=k,n.duals.height=window.innerHeight-S,n.duals.offsetX=i,n.duals.offsetY=j,n.componentOf("//").listen("innerSize",function(a,b){n.duals.height=a[1]-S}),g.length?(g.push(q),n.setChild.apply(n,g)):n.reRender(q)})}function q(){var a=window.innerWidth-330;a=a>=460?Math.floor(.86*a):Math.min(360,window.innerWidth-330),N.style.width=a+"px",M.style.width=a-4+"px",L.style.left=a-24+"px";var b=n.getHtmlNode();if(b){var c=window.getComputedStyle(b).backgroundColor;if(c&&"transparent"!=c){var d=document.querySelector(".popline-frame");d&&(d.style.backgroundColor=c)}}var e=0,f=/^auto[0-9]+$/;h.eachComponent(n,function(a){var b=a.duals.keyid+"";if(0==b.search(f)){var c=parseInt(b.slice(4));c>e&&(e=c)}}),T=e+1}var e,f,g=0,j=!0;if(!Array.isArray(b)||b.length<2||!Array.isArray(c))j=!1;else{if(b[2])return alert("Can not modify immutable paper"),void uc(!0,!0,!1);ba=i.scanWtcFlag(),ca=ba[1],ba=ba[0],e=b[0],f=b[1],Array.isArray(f)&&f.length||(j=!1)}if(j){var k=c.findIndex(function(a){return"sw_base.css"==a.split("/").pop()});k>=0&&c.splice(k,1),l()}else alert("Fatal error: unknown format"),uc(!0,!0,!1)}var d=a("react"),f=(a("react-dom"),a("shadow-widget")),g=f.$main,h=f.$utils,i=f.$creator,j="",k="transform",l=4,m="lib/res/arrows.svg.json",n=null;g.$onLoad.push(function(){if(n=f.W(".body.paper").component,j=document.location.href.split("?")[0],"/"!=j.slice(-1)){var a=j.lastIndexOf("/");a>=0&&(j=j.slice(0,a+1))}var b=h.vendorId||[],c=b[0]||"";"ie"==c?k=b[1]?"transform":"msTransform":"firefox"==c||"opera"==c?k="transform":"chrome"!=c&&"safari"!=c&&"webkit"!=c||(k="WebkitTransform")});var o="",v=(s("#tool-bar"),s("#tool-grid")),w=s("button",v),x=s("input",v),y=s("span",v),z=s("#tool-opacity > input"),A=s("#tool-frameWd > input"),B=s("#tool-arrowIdS"),C=s("#tool-arrowIdE"),D=s("#tool-lineId"),E=s("#tool-alignleft"),F=s("#tool-alignmid"),G=s("#tool-alignright"),H=s("#linestyle_dropdown"),I=s("#arrowstyle_dropdown"),J=s("div.palette-items"),K=s("#text-area > .popline-frame"),L=s("#text-area > .popline-expand"),M=s("#text-area textarea"),N=K.parentNode,O=s("#react-container"),P=s("div.point-nodes"),Q=s("div.halo"),R=s("div.free-transform"),S=70,T=0,U=document.querySelectorAll("#edit-btn > button");t(U[0],"click",function(a){ma(!0)}),t(U[1],"click",function(a){ma(!1)}),U=s("div.palette-items"),t(U,"click",r),t(U,"dblclick",r),t(U,"mouseup",Ba),t(w,"click",oa),t(x,"change",pa),t(z,"mousemove",db),t(z,"mouseout",eb),t(z,"click",gb),t(z,"change",hb),t(A,"mousemove",db),t(A,"mouseout",eb),t(A,"click",jb),t(A,"change",kb),t(B,"click",function(a){pb(a,!0)}),t(C,"click",function(a){pb(a,!1)}),t(D,"click",rb),t(s("img",E),"click",function(a){tb(a,0)}),t(s("img",F),"click",function(a){tb(a,1)}),t(s("img",G),"click",function(a){tb(a,2)}),t("#tool-poptop > img","click",ub),t("#tool-pushbtm > img","click",vb),t(H,"click",sb),t(I,"click",qb),U=s("#color-chart"),t(U,"click",r),t(U,"dblclick",Ca),t(L,"click",na),t(M,"change",_),t(M,"keydown",r),t(M,"drop",fa),t(P,"mousedown",qc),t(R,"mousedown",Pb),t(s(".remove",Q),"click",wb),t(s(".klass",Q),"click",yb),t(s(".clone",Q),"mousedown",Fb),t(s(".link",Q),"mousedown",_b),t(s(".fork",Q),"mousedown",hc),t(s(".rotate",Q),"mousedown",Jb),t(O,"dragover",Rb),t(O,"drop",Tb),t(O,"mousedown",Ya),t(O,"mousemove",_a),t(document.body,"mouseup",bb),t(document.body,"click",function(a){Y(),a.stopPropagation()}),t(document.body,"keydown",cb);var V=null,W={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",feldspar:"#d19275",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslateblue:"#8470ff",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",violetred:"#d02090",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},$="",aa=/([A-Z])/g,ba=null,ca=null,qa="",ra="rgb(119,119,119)",sa="rgb(119,119,119)",ta="",ua=3,va=2,za=0,Aa=0,Ga=null,Ha=!1,Ia=0,Ja=0,Ka=0,La=0,Ma=0,Na=0,Oa=null,Pa=!1,Qa=[],Ra=[],Sa=0,Ta=0,Ua=0,Va=0,Wa=null,Xa=null,lb=!0,mb=["m0,50l100,0","m100,50l-100,40l30,-40l-30,-40z","m20,50c0,-16.57458 13.42542,-30 30,-30c16.57458,0 30,13.42542 30,30c0,16.57458 -13.42542,30 -30,30c-16.57458,0 -30,-13.42542 -30,-30z","m20,20l0,60l60,0l0,-60z","m20,80l60,-60m0,60l-60,-60","m50,0l0,100"],nb=["m0,50l100,0","m0,50l100,40l-30,-40l30,-40z","m20,50c0,-16.57458 13.42542,-30 30,-30c16.57458,0 30,13.42542 30,30c0,16.57458 -13.42542,30 -30,30c-16.57458,0 -30,-13.42542 -30,-30z","m20,20l0,60l60,0l0,-60z","m20,80l60,-60m0,60l-60,-60","m50,0l0,100"],ob=["","1,1","2,2","5,5","5,10","10,5","5,1","15,10,5,10,15"],xb=["align_center-right-default","right-default-align_center","default-align_center-right","left-align_center-right","align_center-right-left","right-left-align_center"],zb=null,Ab=0,Bb=0,Cb=0,Db=0,Gb=null,Hb=0,Ib=0,Kb=null,Lb="",Mb=0,Nb=0,Ob=null,Ub=null,Vb=!1,Wb=!1,Xb=0,Yb=0,Zb=0,$b=0,ac=null,bc=null,cc=!1,dc=0,ec=0,fc=0,gc=0,ic=null,jc=null,kc=0,lc=0,mc=0,nc=0,oc=0,pc=0,rc=0,sc="",tc=null;if(window.parent&&window.parent.window!==window){window.addEventListener("message",function(a){try{"object"==typeof a&&a.data?(a=a.data,a=JSON.parse(a.slice(14))):a=null}catch(b){a=null,console.log(b)}"object"==typeof a&&("init"==a.method?vc(a.param[0],a.param[1],a.param[2]):a.method)},!1);var wc="[PROJECT_NAME]"+JSON.stringify({method:"onDialogLoad",param:[]});window.parent.window.postMessage(wc,"*")}});